import{t as e}from"./IconChevronRight-CHq65dDv.js";import{a as t,c as n,d as r,f as i,i as a,l as o,n as s,o as c,r as l,s as u,t as d,u as f}from"./lib-CqUYMfPh.js";import{$t as p,A as m,Bt as h,Dn as g,Dt as _,E as v,Jt as y,K as b,Mt as x,Nt as ee,Pt as S,Q as te,Qt as C,S as w,W as T,X as ne,Xt as re,Y as ie,Yt as ae,Z as oe,Zt as E,_n as D,_t as O,an as k,bn as A,bt as j,cn as se,dn as M,en as ce,f as le,fn as ue,hn as N,j as de,jt as fe,l as pe,ln as me,lt as he,m as ge,mn as P,mt as _e,nn as ve,on as ye,pn as F,q as be,rn as xe,s as Se,sn as I,tn as L,u as Ce,ut as we,vn as Te,vt as Ee,wn as R,xn as De,yn as Oe,zt as z}from"./index-Cd-3_VMf.js";var ke=S(`outline`,`info-small`,`InfoSmall`,[[`path`,{d:`M12 9h.01`}],[`path`,{d:`M11 12h1v4h1`}]]),Ae=S(`filled`,`zoom-in-filled`,`ZoomInFilled`,[[`path`,{d:`M14 3.072a8 8 0 0 1 2.617 11.424l4.944 4.943a1.5 1.5 0 0 1 -2.008 2.225l-.114 -.103l-4.943 -4.944a8 8 0 0 1 -12.49 -6.332l-.006 -.285l.005 -.285a8 8 0 0 1 11.995 -6.643zm-4 2.928a1 1 0 0 0 -.993 .883l-.007 .117v2h-2l-.117 .007a1 1 0 0 0 0 1.986l.117 .007h2v2l.007 .117a1 1 0 0 0 1.986 0l.007 -.117v-2h2l.117 -.007a1 1 0 0 0 0 -1.986l-.117 -.007h-2v-2l-.007 -.117a1 1 0 0 0 -.993 -.883z`}]]),je=S(`filled`,`zoom-out-filled`,`ZoomOutFilled`,[[`path`,{d:`M14 3.072a8 8 0 0 1 2.617 11.424l4.944 4.943a1.5 1.5 0 0 1 -2.008 2.225l-.114 -.103l-4.943 -4.944a8 8 0 0 1 -12.49 -6.332l-.006 -.285l.005 -.285a8 8 0 0 1 11.995 -6.643zm-1 5.928h-6l-.117 .007a1 1 0 0 0 0 1.986l.117 .007h6l.117 -.007a1 1 0 0 0 0 -1.986l-.117 -.007z`}]]);const Me=async e=>{typeof e==`string`?await navigator.clipboard.writeText(e):await navigator.clipboard.write(e)};var Ne=fe(),Pe=g(y(),1),B=null,{min:V,max:H,abs:Fe,floor:Ie}=Math,Le=(e,t,n)=>V(n,H(t,e)),Re=e=>[...e].sort((e,t)=>e-t),ze=typeof queueMicrotask==`function`?queueMicrotask:e=>{Promise.resolve().then(e)},U=()=>{let e;return[new Promise(t=>{e=t}),e]},W=e=>{let t;return()=>(e&&=(t=e(),void 0),t)},G=-1,K=(e,t,n)=>{let r=n?`unshift`:`push`;for(let n=0;n<t;n++)e[r](G);return e},Be=(e,t)=>{let n=e._sizes[t];return n===G?e._defaultItemSize:n},Ve=(e,t,n)=>{let r=e._sizes[t]===G;return e._sizes[t]=n,e._computedOffsetIndex=V(t,e._computedOffsetIndex),r},q=(e,t)=>{if(!e._length)return 0;if(e._computedOffsetIndex>=t)return e._offsets[t];e._computedOffsetIndex<0&&(e._offsets[0]=0,e._computedOffsetIndex=0);let n=e._computedOffsetIndex,r=e._offsets[n];for(;n<t;)r+=Be(e,n),e._offsets[++n]=r;return e._computedOffsetIndex=t,r},J=(e,t,n=0,r=e._length-1)=>{for(;n<=r;){let i=Ie((n+r)/2);if(q(e,i)<=t){if(q(e,i+1)>t)return i;n=i+1}else r=i-1}return Le(n,0,e._length-1)},He=(e,t,n,r)=>{if(r=V(r,e._length-1),q(e,r)<=t){let i=J(e,n,r);return[J(e,t,r,i),i]}else{let i=J(e,t,void 0,r);return[i,J(e,n,i)]}},Ue=(e,t)=>{let n=0,r=[];e._sizes.forEach((e,i)=>{e!==G&&(r.push(e),i<t&&n++)}),e._computedOffsetIndex=-1;let i=Re(r),a=i.length,o=a/2|0,s=a%2==0?(i[o-1]+i[o])/2:i[o],c=e._defaultItemSize;return((e._defaultItemSize=s)-c)*H(t-n,0)},We=(e,t,n)=>({_defaultItemSize:n?n[1]:t,_sizes:n&&n[0]?K(n[0].slice(0,V(e,n[0].length)),H(0,e-n[0].length)):K([],e),_length:e,_computedOffsetIndex:-1,_offsets:K([],e+1)}),Ge=e=>[e._sizes.slice(),e._defaultItemSize],Y=(e,t,n)=>{let r=t-e._length;return e._computedOffsetIndex=n?-1:V(t-1,e._computedOffsetIndex),e._length=t,r>0?(K(e._offsets,r),K(e._sizes,r,n),e._defaultItemSize*r):(e._offsets.splice(r),(n?e._sizes.splice(0,-r):e._sizes.splice(r)).reduce((t,n)=>t-(n===G?e._defaultItemSize:n),0))},Ke=typeof window<`u`,qe=()=>document.documentElement,Je=e=>e.ownerDocument,Ye=e=>e.defaultView,Xe=W(()=>Ke?getComputedStyle(qe()).direction===`rtl`:!1),Ze=W(()=>/iP(hone|od|ad)/.test(navigator.userAgent)?!0:navigator.platform===`MacIntel`&&navigator.maxTouchPoints>0),Qe=W(()=>`scrollBehavior`in qe().style),$e=2147483647,X=0,et=1,tt=2,Z=0,nt=1,rt=2,it=1,at=2,ot=3,st=4,ct=5,lt=6,ut=7,dt=8,Q=1,ft=2,pt=4,mt=8,ht=e=>H(e.$getTotalSize(),e.$getViewportSize()),gt=(e,t=40,n=0,r,i=!1)=>{let a=!!n,o=1,s=0,c=0,l=0,u=0,d=0,f=0,p=X,m=Z,h=B,g=[0,a?H(n-1,0):-1],_=0,v=We(e,t,r),y=new Set,b=()=>l-c,x=()=>b()+d+u,ee=(e,t)=>He(v,e,t,g[0]),S=()=>q(v,v._length),te=e=>q(v,e)-d,C=e=>Be(v,e),w=(e,t=G)=>v._sizes[e]===t,T=e=>{e&&(Ze()&&p!==X||h&&m===nt?d+=e:u+=e)};return{$dispose:()=>{y.clear()},$getStateVersion:()=>o,$getCacheSnapshot:()=>Ge(v),$getRange:(e=200)=>{if(!s||a)return g;let t,n;if(f)[t,n]=g;else{let r=H(0,x()),a=r+s;i||(e=H(0,e),p!==et&&(r-=e),p!==tt&&(a+=e)),[t,n]=g=ee(H(0,r),H(0,a)),h&&(t=V(t,h[0]),n=H(n,h[1]))}return[H(t,0),V(n,v._length-1)]},$findStartIndex:()=>J(v,x()),$findEndIndex:()=>J(v,x()+s),$isUnmeasuredItem:w,$getItemOffset:te,$getItemSize:C,$getItemsLength:()=>v._length,$getScrollOffset:()=>l,$isScrolling:()=>p!==X,$getViewportSize:()=>s,$getStartSpacerSize:()=>c,$getTotalSize:S,_flushJump:()=>(f=u,u=0,[f,m===rt]),$subscribe:(e,t)=>{let n=[e,t];return y.add(n),()=>{y.delete(n)}},$update:(e,t)=>{let n,r,g=0;switch(e){case it:{if(t===l&&m===Z)break;let e=f;f=0;let n=t-l,i=Fe(n);!(e&&i<Fe(e)+1)&&m===Z&&(p=n<0?tt:et),a&&=!1,l=t,g=pt;let o=b();o>=-s&&o<=S()&&(g+=Q,r=i>s);break}case at:g=mt,p!==X&&(n=!0,g+=Q),p=X,m=Z,h=B;break;case ot:{let e=t.filter(([e,t])=>!w(e,t));if(!e.length)break;T(e.reduce((e,[t,n])=>((m===rt||(h&&m===nt?t<h[0]:te(t+(p===X&&m===Z?1:0))<b()))&&(e+=n-C(t)),e),0));for(let[t,n]of e){let e=C(t),r=Ve(v,t,n);i&&(_+=r?n:n-e)}i&&s&&_>s&&(T(Ue(v,J(v,x()))),i=!1),g=Q+ft,r=!0;break}case st:s!==t&&(s||(r=!0),s=t,g=Q+ft);break;case ct:t[1]?(T(Y(v,t[0],!0)),m=rt,g=Q):(Y(v,t[0]),g=Q);break;case lt:c=t;break;case ut:m=nt;break;case dt:h=ee(t,t+s),g=Q;break}g&&(o=(o&$e)+1,n&&d&&(u+=d,d=0),y.forEach(([e,t])=>{g&e&&t(r)}))}}},_t=setTimeout,vt=(e,t)=>{let n,r=()=>{n!=B&&clearTimeout(n)},i=()=>{r(),n=_t(()=>{n=B,e()},t)};return i._cancel=r,i},yt=(e,t)=>t&&Xe()?-e:e,bt=(e,t,n,r,i,a)=>{let o=Date.now,s=0,c=!1,l=!1,u=!1,d=!1,f=vt(()=>{if(c||l){c=!1,f();return}u=!1,e.$update(at)},150),p=()=>{s=o(),u&&(d=!0),a&&e.$update(lt,a()),e.$update(it,r()),f()},m=t=>{if(c||!e.$isScrolling()||t.ctrlKey)return;let r=o()-s;150>r&&50<r&&(n?t.deltaX:t.deltaY)&&(c=!0)},h=()=>{l=!0,u=d=!1},g=()=>{l=!1,Ze()&&(u=!0)};return t.addEventListener(`scroll`,p),t.addEventListener(`wheel`,m,{passive:!0}),t.addEventListener(`touchstart`,h,{passive:!0}),t.addEventListener(`touchend`,g,{passive:!0}),{_dispose:()=>{t.removeEventListener(`scroll`,p),t.removeEventListener(`wheel`,m),t.removeEventListener(`touchstart`,h),t.removeEventListener(`touchend`,g),f._cancel()},_fixScrollJump:()=>{let[t,a]=e._flushJump();t&&(i(yt(t,n),a,d),d=!1,a&&e.$getViewportSize()>e.$getTotalSize()&&e.$update(it,r()))}}},xt=(e,t,n)=>{let r;return[async(i,a)=>{if(!await t())return;r&&r();let o=()=>{let[t,n]=U();return r=()=>{n(!1)},e.$getViewportSize()&&_t(r,150),[t,e.$subscribe(ft,()=>{n(!0)})]};if(a&&Qe())e.$update(dt,i()),ze(async()=>{for(;;){let t=!0;for(let[n,r]=e.$getRange();n<=r;n++)if(e.$isUnmeasuredItem(n)){t=!1;break}if(t)break;let[n,r]=o();try{if(!await n)return}finally{r()}}e.$update(ut),n(i(),a)});else for(;;){let[t,r]=o();try{if(e.$update(ut),n(i()),!await t)return}finally{r()}}},()=>{r&&r()}]},St=(e,t)=>{let n,r,i=U(),a=t?`scrollLeft`:`scrollTop`,o=t?`overflowX`:`overflowY`,[s,c]=xt(e,()=>i[0],(e,r)=>{e=yt(e,t),r?n.scrollTo({[t?`left`:`top`]:e,behavior:`smooth`}):n[a]=e});return{$observe(s){n=s,r=bt(e,s,t,()=>yt(s[a],t),(t,n,r)=>{if(r){let e=s.style,t=e[o];e[o]=`hidden`,_t(()=>{e[o]=t})}s[a]=e.$getScrollOffset()+t,n&&c()}),i[1](!0)},$dispose(){r&&r._dispose(),i[1](!1),i=U()},$scrollTo(e){s(()=>e)},$scrollBy(t){t+=e.$getScrollOffset(),s(()=>t)},$scrollToIndex(t,{align:n,smooth:r,offset:i=0}={}){if(t=Le(t,0,e.$getItemsLength()-1),n===`nearest`){let r=e.$getItemOffset(t),i=e.$getScrollOffset();if(r<i)n=`start`;else if(r+e.$getItemSize(t)>i+e.$getViewportSize())n=`end`;else return}s(()=>i+e.$getStartSpacerSize()+e.$getItemOffset(t)+(n===`end`?e.$getItemSize(t)-e.$getViewportSize():n===`center`?(e.$getItemSize(t)-e.$getViewportSize())/2:0),r)},$fixScrollJump:()=>{r&&r._fixScrollJump()}}},Ct=e=>{let t;return{_observe(n){(t||=new(Ye(Je(n))).ResizeObserver(e)).observe(n)},_unobserve(e){t.unobserve(e)},_dispose(){t&&t.disconnect()}}},wt=(e,t)=>{let n,r=t?`width`:`height`,i=new WeakMap,a=Ct(t=>{let a=[];for(let{target:o,contentRect:s}of t)if(o.offsetParent)if(o===n)e.$update(st,s[r]);else{let e=i.get(o);e!=B&&a.push([e,s[r]])}a.length&&e.$update(ot,a)});return{$observeRoot(e){a._observe(n=e)},$observeItem:(e,t)=>(i.set(e,t),a._observe(e),()=>{i.delete(e),a._unobserve(e)}),$dispose:a._dispose}},Tt=e=>{let t;e=Te({_as:`div`},e),F(()=>{t&&A(e._resizer(t,e._index))});let n=P(()=>{let t=e._isHorizontal,n={contain:`layout style`,position:`absolute`,[t?`height`:`width`]:`100%`,[t?`top`:`left`]:`0px`,[t?Xe()?`right`:`left`:`top`]:e._offset+`px`,visibility:e._hide?`hidden`:void 0};return t&&(n.display=`inline-flex`),n});return M(ae,{get component(){return e._as},get index(){return e._index},ref(e){var n=t;typeof n==`function`?n(e):t=e},get style(){return n()},get children(){return e._children}})},Et=(e,t)=>e[0]===t[0]&&e[1]===t[1],Dt=e=>{let t,{itemSize:n,horizontal:r=!1,cache:i}=e;e=Te({as:`div`},e);let a=gt(e.data.length,n,void 0,i,!n),o=wt(a,r),s=St(a,r),[c,l]=D(a.$getStateVersion());a.$subscribe(Q,()=>{l(a.$getStateVersion())}),a.$subscribe(pt,()=>{var t;(t=e.onScroll)==null||t.call(e,a.$getScrollOffset())}),a.$subscribe(mt,()=>{var t;(t=e.onScrollEnd)==null||t.call(e)});let u=P(t=>{c();let n=a.$getRange(e.bufferSize);return t&&Et(t,n)?t:n}),d=P(()=>c()&&a.$isScrolling()),f=P(()=>c()&&a.$getTotalSize());De(()=>{e.ref&&e.ref({get cache(){return a.$getCacheSnapshot()},get scrollOffset(){return a.$getScrollOffset()},get scrollSize(){return ht(a)},get viewportSize(){return a.$getViewportSize()},findStartIndex:a.$findStartIndex,findEndIndex:a.$findEndIndex,getItemOffset:a.$getItemOffset,getItemSize:a.$getItemSize,scrollToIndex:s.$scrollToIndex,scrollTo:s.$scrollTo,scrollBy:s.$scrollBy});let n=e.scrollRef||t.parentElement;o.$observeRoot(n),s.$observe(n),A(()=>{e.ref&&e.ref(),a.$dispose(),o.$dispose(),s.$dispose()})}),ue(Oe(()=>e.startMargin||0,e=>{e!==a.$getStartSpacerSize()&&a.$update(lt,e)})),F(Oe(c,()=>{s.$fixScrollJump()}));let p=P(()=>{let t=e.data.length;R(()=>{t!==a.$getItemsLength()&&a.$update(ct,[t,e.shift])});let n=[],r=[];if(e.keepMounted){let t=new Set(e.keepMounted);for(let[e,n]=u();e<=n;e++)t.add(e);Re([...t]).forEach(t=>{n.push(e.data[t]),r.push(t)})}else for(let[t,i]=u();t<=i;t++)n.push(e.data[t]),r.push(t);return{_items:n,_indexes:r}}),m=(t,n)=>{let i=P(()=>(c(),a.$getItemOffset(n()))),s=P(()=>(c(),a.$isUnmeasuredItem(n()))),l=P(()=>R(()=>e.children(t,n)));return M(Tt,{get _as(){return e.item},get _index(){return n()},get _resizer(){return o.$observeItem},get _offset(){return i()},get _hide(){return s()},get _children(){return l()},_isHorizontal:r})};return M(ae,{get component(){return e.as},ref(e){var n=t;typeof n==`function`?n(e):t=e},get style(){return{contain:`size style`,"overflow-anchor":`none`,flex:`none`,position:`relative`,width:r?f()+`px`:`100%`,height:r?`100%`:f()+`px`,"pointer-events":d()?`none`:void 0}},get children(){return M(I,{get each(){return p()._items},children:(e,t)=>m(e,P(()=>p()._indexes[t()]))})}})},Ot=k(`<div class="flex h-4 items-center">`),kt=k(`<span class=align-middle>`),At=k(`<div class="flex h-full flex-col gap-2"><div class="flex w-full flex-wrap items-center gap-2"><div class="flex items-center gap-2"><div class="tabs-box tabs gap-2 tabs-sm"></div><div class="flex items-center"><span class="mr-2 hidden lg:inline-block">:</span><input type=checkbox class=toggle></div><select class="select flex-1 select-sm select-primary"><option value></option></select></div><div class="flex items-center gap-2"><span class="w-32 text-sm sm:inline-block"></span><select class="select select-sm select-primary"></select></div><div class="join flex flex-1 items-center"><input type=search class="input input-sm join-item flex-1 input-primary"></div></div><div class="h-full overflow-x-auto rounded-md bg-base-300"><table><thead class="hidden md:table-header-group">`),jt=k(`<button><span></span><div class="badge badge-sm">`),Mt=k(`<option>`),Nt=k(`<div class="loading loading-spinner">`),Pt=k(`<tr class=flex>`),Ft=k(`<th><div class="flex items-center gap-2"><div>`),It=k(`<button class=cursor-pointer>`),Lt=k(`<tr>`),Rt=k(`<td><div class="justify mb-0.5 text-[10px] text-base-content/60 uppercase md:hidden">`),zt=k(`<button><div></div><div></div><div>(<!>)`),$=function(e){return e[e.activeConnections=0]=`activeConnections`,e[e.closedConnections=1]=`closedConnections`,e}($||{}),Bt=(e,t,r,i)=>{let a=n(e.getValue(t),r);return i({itemRank:a}),a.passed},Vt=()=>{let n=le();if(!ge())return n(`/setup`,{replace:!0}),null;let g,y,[S]=O(),[C,ae]=D($.activeConnections),{activeConnections:k,closedConnections:A,paused:ce,setPaused:ue}=be(),[fe,R]=D(!1),[De,B]=D(``),[V,H]=Ee(D(!1),{name:`enableQuickFilter`,storage:localStorage}),[Fe,Ie]=D(),Le=[{meta:{headerKey:`details`},header:()=>S(`details`),enableGrouping:!1,enableSorting:!1,enableColumnFilter:!1,enableGlobalFilter:!1,accessorKey:j.Details,cell:({row:e})=>(()=>{var t=Ot();return p(t,M(z,{class:`btn-circle btn-xs`,onClick:()=>{Ie(e.original.id),y?.showModal()},get icon(){return M(ke,{size:`16`})}})),t})()},{meta:{headerKey:`close`},header:()=>S(`close`),enableGrouping:!1,enableSorting:!1,enableColumnFilter:!1,enableGlobalFilter:!1,accessorKey:j.Close,cell:({row:e})=>(()=>{var t=Ot();return p(t,M(z,{class:`btn-circle btn-xs`,onClick:()=>de(e.original.id),get icon(){return M(x,{size:`16`})}})),t})()},{meta:{headerKey:`ID`},header:()=>S(`ID`),enableGrouping:!1,accessorKey:j.ID,accessorFn:e=>e.id},{meta:{headerKey:`type`},header:()=>S(`type`),accessorKey:j.Type,accessorFn:e=>`${e.metadata.type}(${e.metadata.network})`},{meta:{headerKey:`process`},header:()=>S(`process`),accessorKey:j.Process,accessorFn:e=>e.metadata.process||e.metadata.processPath.replace(/^.*[/\\](.*)$/,`$1`)||`-`},{meta:{headerKey:`host`},header:()=>S(`host`),accessorKey:j.Host,accessorFn:e=>`${e.metadata.host?e.metadata.host:v(e.metadata.destinationIP)}:${e.metadata.destinationPort}`},{meta:{headerKey:`sniffHost`},header:()=>S(`sniffHost`),accessorKey:j.SniffHost,accessorFn:e=>e.metadata.sniffHost||`-`},{meta:{headerKey:`rule`},header:()=>S(`rule`),accessorKey:j.Rule,accessorFn:e=>e.rulePayload?`${e.rule} : ${e.rulePayload}`:e.rule},{meta:{headerKey:`chains`},header:()=>S(`chains`),accessorKey:j.Chains,cell:({row:t})=>M(I,{get each(){return t.original.chains.slice().reverse()},children:(t,n)=>[M(me,{get when(){return n()},get children(){return M(e,{class:`inline-block`,size:18})}}),(()=>{var e=kt();return p(e,t),e})()]})},{meta:{headerKey:`connectTime`},header:()=>S(`connectTime`),enableGrouping:!1,accessorKey:j.ConnectTime,accessorFn:e=>w(e.start),sortingFn:(e,t)=>(0,Pe.default)(e.original.start).valueOf()-(0,Pe.default)(t.original.start).valueOf()},{meta:{headerKey:`dlSpeed`},header:()=>S(`dlSpeed`),enableGrouping:!1,accessorKey:j.DlSpeed,accessorFn:e=>`${_(e.downloadSpeed)}/s`,sortingFn:(e,t)=>e.original.downloadSpeed-t.original.downloadSpeed},{meta:{headerKey:`ulSpeed`},header:()=>S(`ulSpeed`),enableGrouping:!1,accessorKey:j.UlSpeed,accessorFn:e=>`${_(e.uploadSpeed)}/s`,sortingFn:(e,t)=>e.original.uploadSpeed-t.original.uploadSpeed},{meta:{headerKey:`dl`},header:()=>S(`dl`),enableGrouping:!1,accessorKey:j.Download,accessorFn:e=>_(e.download),sortingFn:(e,t)=>e.original.download-t.original.download},{meta:{headerKey:`ul`},header:()=>S(`ul`),enableGrouping:!1,accessorKey:j.Upload,accessorFn:e=>_(e.upload),sortingFn:(e,t)=>e.original.upload-t.original.upload},{meta:{headerKey:`sourceIP`},header:()=>S(`sourceIP`),accessorKey:j.SourceIP,accessorFn:e=>{let t=e.metadata.sourceIP||S(`inner`);return ie().find(e=>e.sourceIP===t)?.tagName||t}},{meta:{headerKey:`sourcePort`},header:()=>S(`sourcePort`),accessorKey:j.SourcePort,accessorFn:e=>e.metadata.sourcePort},{meta:{headerKey:`destination`},header:()=>S(`destination`),accessorKey:j.Destination,accessorFn:e=>e.metadata.remoteDestination||e.metadata.destinationIP||e.metadata.host},{meta:{headerKey:`inboundUser`},header:()=>S(`inboundUser`),accessorKey:j.InboundUser,accessorFn:e=>e.metadata.inboundUser||e.metadata.inboundName||e.metadata.inboundPort}],[Re,ze]=D([]),[U,W]=Ee(D([{id:j.ConnectTime,desc:!0}]),{name:`connectionsTableSorting`,storage:localStorage}),G=d({filterFns:{fuzzy:Bt},state:{get columnOrder(){return ne()},get grouping(){return Re()},get sorting(){return U()},get columnVisibility(){return oe()},get globalFilter(){return De()}},get data(){let e=C()===$.activeConnections?k():A();if(e.sort((e,t)=>e.id.localeCompare(t.id)),!V())return e;let t=new RegExp(b(),`i`);return e.filter(e=>!t.test(e.chains.join(``)))},sortDescFirst:!0,enableHiding:!0,columns:Le,onGlobalFilterChange:B,globalFilterFn:Bt,onGroupingChange:ze,onSortingChange:W,getFilteredRowModel:t(),getSortedRowModel:u(),getExpandedRowModel:a(),getGroupedRowModel:c(),getCoreRowModel:l()}),[K,Be]=D(U()[0]?.id||j.ConnectTime),[Ve,q]=D(U()[0]?.desc??!0);F(Oe(U,()=>{let e=U();e.length&&(Be(e[0].id),q(!!e[0].desc))}));let J=P(()=>G.getAllLeafColumns().filter(e=>e.getCanSort()).map(e=>({id:e.id,key:e.columnDef.meta?.headerKey})).filter(e=>!!e.key)),He=G.getFlatHeaders().find(({id:e})=>e===j.SourceIP),[Ue,We]=D(``);F(Oe(Ue,()=>{let e=ie().find(e=>e.sourceIP===Ue());He?.column.setFilterValue(e?e.tagName:Ue())}));let Ge=P(()=>[{type:$.activeConnections,name:S(`active`),count:k().length},{type:$.closedConnections,name:S(`closed`),count:A().length}]),Y;return[M(Se,{get children(){return S(`connections`)}}),(()=>{var e=At(),t=e.firstChild,n=t.firstChild,a=n.firstChild,c=a.nextSibling,l=c.firstChild,u=l.firstChild,d=l.nextSibling,_=c.nextSibling,v=_.firstChild,b=n.nextSibling,w=b.firstChild,D=w.nextSibling,O=b.nextSibling,k=O.firstChild,A=t.nextSibling,le=A.firstChild,me=le.firstChild;p(a,M(se,{get each(){return Ge()},children:e=>(()=>{var t=jt(),n=t.firstChild,r=n.nextSibling;return t.$$click=()=>ae(e().type),p(n,()=>e().name),p(r,()=>e().count),N(()=>E(t,h(C()===e().type&&`bg-primary text-neutral!`,`tab gap-2 px-2`))),t})()})),p(l,()=>S(`quickFilter`),u),d.addEventListener(`change`,e=>H(e.target.checked)),_.addEventListener(`change`,e=>We(e.target.value)),p(v,()=>S(`all`)),p(_,M(se,{get each(){return(0,Ne.uniq)(T().map(({metadata:{sourceIP:e}})=>{let t=e||S(`inner`);return ie().find(e=>e.sourceIP===t)?.tagName||t})).sort()},children:e=>(()=>{var t=Mt();return p(t,e),N(()=>t.value=e()),t})()}),null),p(w,()=>S(`sortBy`)),D.addEventListener(`change`,e=>{let t=e.target.value;Be(t),W([{id:t,desc:Ve()}])}),p(D,M(se,{get each(){return J()},children:e=>(()=>{var t=Mt();return p(t,()=>S(e().key)),N(()=>t.value=e().id),t})()})),p(b,M(z,{class:`btn btn-sm btn-primary`,onClick:()=>{let e=!Ve();q(e),W([{id:K(),desc:e}])},get icon(){return L(()=>!!Ve())()?M(o,{}):M(f,{})}}),null),k.$$input=e=>B(e.target.value),p(O,M(z,{class:`btn join-item btn-sm btn-primary`,onClick:()=>ue(e=>!e),get icon(){return L(()=>!!ce())()?M(r,{}):M(i,{})}}),null),p(O,M(z,{class:`btn join-item btn-sm btn-primary`,onClick:async()=>{R(!0),G.getState().globalFilter?await Promise.allSettled(G.getFilteredRowModel().rows.map(({original:e})=>de(e.id))):await m(),R(!1)},get icon(){return L(()=>!!fe())()?Nt():M(x,{})}}),null),p(O,M(z,{class:`btn join-item btn-sm btn-primary`,onClick:()=>g?.showModal(),get icon(){return M(ee,{})}}),null);var ge=Y;return typeof ge==`function`?ye(ge,A):Y=A,p(me,M(I,{get each(){return G.getHeaderGroups()},children:e=>(()=>{var t=Pt();return p(t,M(I,{get each(){return e.headers},children:e=>(()=>{var t=Ft(),n=t.firstChild,r=n.firstChild;return re(r,`click`,e.column.getToggleSortingHandler(),!0),p(r,()=>s(e.column.columnDef.header,e.getContext())),p(n,()=>({asc:M(f,{}),desc:M(o,{})})[e.column.getIsSorted()]??null,null),p(n,(()=>{var t=L(()=>!!e.column.getCanGroup());return()=>t()?(()=>{var t=It();return re(t,`click`,e.column.getToggleGroupingHandler(),!0),p(t,(()=>{var t=L(()=>!!e.column.getIsGrouped());return()=>t()?M(je,{size:18}):M(Ae,{size:18})})()),t})():null})(),null),N(n=>{var i=h(`w-36 min-w-36 bg-base-200 sm:w-40 sm:min-w-40 md:w-44 md:min-w-44 lg:w-24`,(e.id===j.Details||e.id===j.Close)&&`md:w-16 md:min-w-16 lg:w-14 lg:min-w-14`,(e.id===j.ID||e.id===j.Host||e.id===j.SniffHost)&&`md:w-64 md:min-w-64`,e.id===j.Chains&&`md:w-80 md:min-w-80`),a=h(e.column.getCanSort()&&`cursor-pointer select-none`,`text-xs wrap-break-word whitespace-normal`);return i!==n.e&&E(t,n.e=i),a!==n.t&&E(r,n.t=a),n},{e:void 0,t:void 0}),t})()})),t})()})),p(le,M(Dt,{scrollRef:Y,get data(){return G.getRowModel().rows},as:`tbody`,item:e=>(()=>{var t=Lt();return xe(t,Te(e,{class:`even:bg-base-500 flex flex-wrap rounded-xl border-4 border-base-300 px-2 odd:bg-base-100 md:table-row md:rounded-none md:border-0 md:px-0`}),!1,!1),t})(),children:e=>M(I,{get each(){return e.getVisibleCells()},children:t=>(()=>{var n=Rt(),r=n.firstChild;return n.$$contextmenu=e=>{e.preventDefault();let n=t.renderValue();n&&Me(n).catch(()=>{})},p(r,()=>{let e=t.column.columnDef.meta?.headerKey;return e?S(e):``}),p(n,(()=>{var n=L(()=>!!t.getIsGrouped());return()=>n()?(()=>{var n=zt(),r=n.firstChild,i=r.nextSibling,a=i.nextSibling,o=a.firstChild.nextSibling;return o.nextSibling,re(n,`click`,e.getToggleExpandedHandler(),!0),p(r,(()=>{var t=L(()=>!!e.getIsExpanded());return()=>t()?M(je,{size:18}):M(Ae,{size:18})})()),p(i,()=>s(t.column.columnDef.cell,t.getContext())),p(a,()=>e.subRows.length,o),N(()=>E(n,h(e.getCanExpand()?`cursor-pointer`:`cursor-normal`,`flex items-center gap-2`))),n})():L(()=>!!t.getIsAggregated())()?s(t.column.columnDef.aggregatedCell??t.column.columnDef.cell,t.getContext()):L(()=>!!t.getIsPlaceholder())()?null:s(t.column.columnDef.cell,t.getContext())})(),null),N(()=>E(n,h(`md:-1.5 w-1/2 min-w-[50%] pb-1.5 text-justify align-top wrap-break-word nth-[2n]:text-right nth-last-[2]:mb-3 sm:w-1/3 sm:min-w-[33.333%] sm:nth-[2n]:text-justify sm:nth-[3n]:text-right md:inline-block md:w-44 md:min-w-44 md:py-3 md:text-start md:nth-[2n]:text-start md:nth-[3n]:text-start md:nth-last-[2]:mb-3 lg:w-24`,(t.column.id===j.Details||t.column.id===j.Close)&&`md:w-16 md:min-w-16 lg:w-14 lg:min-w-14`,(t.column.id===j.ID||t.column.id===j.Host||t.column.id===j.SniffHost)&&`md:w-64 md:min-w-64`,t.column.id===j.Chains&&`md:w-80 md:min-w-80`))),n})()})}),null),p(e,M(Ce,{ref:e=>g=e,get order(){return ne()},get visible(){return oe()},onOrderChange:e=>he(e),onVisibleChange:e=>we({...e})}),null),p(e,M(pe,{ref:e=>y=e,get selectedConnectionID(){return Fe()}}),null),N(e=>{var t=S(`search`),n=h(_e(te()),`table-pin-rows table table-zebra`);return t!==e.e&&ve(k,`placeholder`,e.e=t),n!==e.t&&E(le,e.t=n),e},{e:void 0,t:void 0}),N(()=>d.checked=V()),N(()=>D.value=K()),e})()]};C([`input`,`click`,`contextmenu`]);export{Vt as default};